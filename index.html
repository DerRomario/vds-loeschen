<!DOCTYPE html>
<html lang="de">
<head>
	<meta charset="utf-8">
	<title>Piratenpartei Austrittsgenerator</title>


	<link rel="stylesheet" href="./css/foundation.min.css">

	<script type="text/javascript" src="./js/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="./js/foundation.min.js"></script>
	<script type="text/javascript" src="./js/jspdf.js"></script>
	<script type="text/javascript" src="./js/libs/Deflate/adler32cs.js"></script>
	<script type="text/javascript" src="./js/libs/FileSaver.js/FileSaver.js"></script>
	<script type="text/javascript" src="./js/libs/Blob.js/BlobBuilder.js"></script>
	<script type="text/javascript" src="./js/jspdf.plugin.ie_below_9_shim.js"></script>
	<script type="text/javascript" src="./js/jspdf.plugin.split_text_to_size.js"></script>
	<script type="text/javascript" src="./js/jspdf.plugin.standard_fonts_metrics.js"></script>
	<script type="text/javascript" src="./js/mustache.js"></script>
	
</head>

<body>
	<div class="row" style="max-width:50em">
		<h1>Piratenpartei Austrittsgenerator</h1>
  <div class="small-12"><div class="panel">
  	<label>Identifizierungsmerkmale</label>
<div class="row">
      <div class="large-6 columns">
        <input type="text" placeholder="Name" id="name">
      </div>
      <div class="large-6 columns">
        <input type="text" placeholder="Mitgliedsnummer (wenn vorhanden)" id="memberid">
      </div>

      <div class="large-6 columns">
        <input type="text" placeholder="Straße und Hausnummer" id="address">
      </div>
      <div class="large-6 columns">
        <input type="text" placeholder="Stadt und Postleitzahl" id="city">
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns">
        <label>Austrittsgrund</label>
        <textarea name="reason" cols="50" rows="10" id="reason"></textarea>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns">
        <label>Grußformel</label>
        <select id="valediction">
        	<option>Mit freundlichen Grüßen,</option>
        	<option>Mit unfreundlichen Grüßen,</option>
        	<option>Hochachtungsvoll,</option>
        	<option>Enttäuscht,</option>
        	<option>Genervt,</option>
        	<option>Voller Wut,</option>
        	<option>Mit den gesellschaftlich gebotenen gerade noch freundlichen Grüßen,</option>
        	<option>Arrrrgh,</option>
        	<option>ROFLCOPTER GTFO</option>
        </select>
      </div>
    </div>
</div>

<div class="row">
	<div class="large-6 columns">
		<a href="javascript:renderPDF()" class="button success">Download</a>
	</div>
	<div class="large-6 columns">
		<h4>How-To</h4>
		<ol>
			<li>Formular ausfüllen</li>
			<li>PDF herunterladen</li>
			<li>ausdrucken</li>
			<li>In Briefumschlag stecken und abschicken</li>
		</ol>
	</div>
</div>

<p style="color:#999">Hinweis: Es werden keine Daten gespeichert, das PDF wird lokale per Javascript generiert</p>

<script>

function renderPDF() {

	var name= $("#name").val()
	var memberid= $("#memberid").val()
	var address= $("#address").val()
	var city = $("#city").val()
	var reason= $("#reason").val()
	var valediction= $("#valediction option:selected").val()

		var view = {
	  name: name,
	  memberid: memberid,
	  reason:reason
	};

	if(memberid != "") {
		var text = Mustache.render("Sehr geehrter Vorstand,\n\nHiermit beende ich, {{name}} (Mitgliedsnummer: {{memberid}}) meine Mitgliedschaft bei der Piratenpartei Deutschland. {{reason}}", view);
	} else {
		var text = Mustache.render("Sehr geehrter Vorstand,\n\nHiermit beende ich, {{name}} meine Mitgliedschaft bei der Piratenpartei Deutschland. {{reason}}", view);
	}

	var doc = new jsPDF();
	doc.setFontSize(13);

	doc.text(27,  56, "Piratenpartei Deutschland")
	doc.text(27,  64, "Pflugstraße 9a");
	doc.text(27,  74,"10115 Berlin");

	doc.text(150,  30, name)
	doc.text(150,  38, address);
	doc.text(150,  46,city);

	doc.setFontSize(16);
	lines = doc.splitTextToSize(text, 180)
	doc.text(20, 100, lines)

	doc.text(20, 200, valediction);
	doc.setDrawColor(100,100,100);
	doc.line(20, 215, 80, 215);
	doc.text(20, 222, name)
	ga('send', 'pageview', '/render-pdf');
	doc.output("datauri");
}
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40836067-1', 'github.io');
  ga('send', 'pageview');

</script>

</body>
</html>